<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">


    <meta property="fb:app_id" content="575939839496604" />
    <meta property="og:url" content="http://battito.cuoredinapoli.net">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Battito del #CUOREDINAPOLI">
    <meta property="og:description" content="Dedicalo anche tu a chi vuoi!">
    <meta property="og:image" content="img/fb.jpg">
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="600">


    <link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.0.5/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.23.0/es6-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/timesync/timesync.js"></script>


    <script>
  window.fbAsyncInit = function() {
    FB.init({
      appId            : '575939839496604',
      autoLogAppEvents : true,
      xfbml            : true,
      version          : 'v2.10'
    });
    FB.AppEvents.logPageView();
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/it_IT/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
    </script>



    <script>
// create a timesync client
    var ts = timesync.create({
      server: '/timesync',
      interval: 10000
    });
    // get notified on changes in the offset
    ts.on('change', function (offset) {
      console.log('changed offset: ' + offset + ' ms');
    });
    //get synchronized time
    setInterval(function () {
      var now = new Date(ts.now());
      var battiti = Math.floor((( ts.now() - 1543243797977)/1000)/3);
      $('#counter').html(battiti);
      var twittCompleteUrl = "https://twitter.com/share?text=Sto%20dedicando%20il%20battito%20n.%20" + battiti + ".%0D%0ADedicalo%20anche%20tu%20su%20http://cuoredinapoli.net";
      var fbCompleteUrl = "https://www.facebook.com/sharer/sharer.php?u=battito.cuoredinapoli.net?b=" + battiti ;
      var waCompleteUrl = "https://api.whatsapp.com/send?text=Ti%20sto%20dedicando%20il%20battito%20n.%20" + battiti + ".%0D%0ADedicalo%20anche%20tu%20su%20http://cuoredinapoli.net";


      $("#donotwit").attr('href', twittCompleteUrl);
      $("#donofb").attr('href', fbCompleteUrl);
      $("#donowa").attr('href', waCompleteUrl);
        var overTitle = "Sto dedicando il battito n. "+ battiti;
        shareOverrideOGMeta(overTitle);


});



      if(now.getSeconds()%3!=0){
        $('#cover').addClass('beat');
      }
      else{
        $('#cover').removeClass('beat');
      }

    }, 1);




function shareOverrideOGMeta(overrideTitle)
{
    FB.ui({
        method: 'share_open_graph',
        action_type: 'og.likes',
        action_properties: JSON.stringify({
            object: {
                'og:title' : overrideTitle
            }
        })
    },
    function (response) {
    // Action after response
    });

    </script>
</head>
<body>
    <div id="cover" class="beat"></div>
    <div id="battito">
        <h2><span id="counter">52501</span></h2>
        <div id="social-icons">
            <p id="test"></p>
            <a id="donofb" href="#" onclick="return !window.open(this.href, &#39;Facebook&#39;, &#39;width=500,height=500&#39;)"><img src="img/FB.svg" width="30px" alt="Facebook"></a>
            <a id="donotwit" href="#" onclick="return !window.open(this.href, &#39;Twitter&#39;, &#39;width=500,height=500&#39;)" target="_blank"><img src="img/TW.svg" width="30px" alt="Twitter"></a>
            <a id="donowa" href="#" onclick="return !window.open(this.href, &#39;Whatsapp&#39;, &#39;width=500,height=500&#39;)" target="_blank"><img src="img/WA.svg" width="30px" alt="Whatsapp"></a>
        </div>
    </div>



</body>
</html>